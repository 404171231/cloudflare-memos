import{j as e}from"./radix-vendor-C59FrWl4.js";import{o as s}from"./mobx-vendor-DqSTJMYi.js";import{r as t}from"./leaflet-vendor-lQi0KVke.js";import{u as a,a as l,b as r,w as o,I as i,B as n,L as m,U as d,F as c,G as u,d as f,i as x,n as p}from"./index-DbdC5ZdO.js";import{A as h}from"./AuthFooter-BEQO6_1V.js";import{L as j}from"./router-vendor-CwTeFqe9.js";import"./mermaid-vendor-Bc-icxuX.js";import"./i18n-vendor-U-o9p_NC.js";import"./utils-vendor-DZvAiLrS.js";import"./highlight-vendor-CXi3tuUt.js";import"./katex-vendor-DMFz0ZL2.js";import"./ThemeSelect-2RBX34Tf.js";const g=s(()=>{const s=a(),g=l(),w=r(!1),[v,y]=t.useState(""),[N,b]=t.useState(""),C=o.state.generalSetting,S=async()=>{if(""!==v&&""!==N&&!w.isLoading){try{w.setLoading();const e=d.fromPartial({username:v,password:N,role:c.USER});await u.createUser({user:e}),await f.createSession({passwordCredentials:{username:v,password:N}}),await x(),g("/")}catch(e){p.error(e.details||"Sign up failed")}w.setFinish()}};return e.jsxs("div",{className:"py-4 sm:py-8 w-80 max-w-full min-h-svh mx-auto flex flex-col justify-start items-center",children:[e.jsxs("div",{className:"w-full py-4 grow flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"w-full flex flex-row justify-center items-center mb-6",children:[e.jsx("img",{className:"h-14 w-auto rounded-full shadow",src:C.customProfile?.logoUrl||"/logo.webp",alt:""}),e.jsx("p",{className:"ml-2 text-5xl text-foreground opacity-80",children:C.customProfile?.title||"Memos"})]}),C.disallowUserRegistration?e.jsx("p",{className:"w-full text-2xl mt-2 text-muted-foreground",children:"Sign up is not allowed."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"w-full text-2xl mt-2 text-muted-foreground",children:s("auth.create-your-account")}),e.jsxs("form",{className:"w-full mt-2",onSubmit:e=>{e.preventDefault(),S()},children:[e.jsxs("div",{className:"flex flex-col justify-start items-start w-full gap-4",children:[e.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[e.jsx("span",{className:"leading-8 text-muted-foreground",children:s("common.username")}),e.jsx(i,{className:"w-full bg-background h-10",type:"text",readOnly:w.isLoading,placeholder:s("common.username"),value:v,autoComplete:"username",autoCapitalize:"off",spellCheck:!1,onChange:e=>{const s=e.target.value;y(s)},required:!0})]}),e.jsxs("div",{className:"w-full flex flex-col justify-start items-start",children:[e.jsx("span",{className:"leading-8 text-muted-foreground",children:s("common.password")}),e.jsx(i,{className:"w-full bg-background h-10",type:"password",readOnly:w.isLoading,placeholder:s("common.password"),value:N,autoComplete:"password",autoCapitalize:"off",spellCheck:!1,onChange:e=>{const s=e.target.value;b(s)},required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-end items-center w-full mt-6",children:e.jsxs(n,{type:"submit",className:"w-full h-10",disabled:w.isLoading,onClick:S,children:[s("common.sign-up"),w.isLoading&&e.jsx(m,{className:"w-5 h-auto ml-2 animate-spin opacity-60"})]})})]})]}),o.state.profile.owner?e.jsxs("p",{className:"w-full mt-4 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:s("auth.sign-in-tip")}),e.jsx(j,{to:"/auth",className:"cursor-pointer ml-2 text-primary hover:underline",viewTransition:!0,children:s("common.sign-in")})]}):e.jsx("p",{className:"w-full mt-4 text-sm font-medium text-muted-foreground",children:s("auth.host-tip")})]}),e.jsx(h,{})]})});export{g as default};
